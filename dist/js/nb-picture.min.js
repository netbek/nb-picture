/*
 * nb-picture
 * https://github.com/netbek/nb-picture
 * @author Hein Bekker <hein@netbek.co.za>
 * @copyright (c) 2015 Hein Bekker
 * @license http://www.gnu.org/licenses/agpl-3.0.txt AGPLv3
 */
!function(a,b){"use strict";function c(a){return a.picturefill}function d(){var a={mediaqueries:{small:"only screen and (min-width: 0px)",medium:"only screen and (min-width: 640px)",large:"only screen and (min-width: 992px)",xlarge:"only screen and (min-width: 1440px)",xxlarge:"only screen and (min-width: 1920px)",landscape:"only screen and (orientation: landscape)",portrait:"only screen and (orientation: portrait)",retina:"only screen and (-webkit-min-device-pixel-ratio: 2), only screen and (min--moz-device-pixel-ratio: 2), only screen and (-o-min-device-pixel-ratio: 2/1), only screen and (min-device-pixel-ratio: 2), only screen and (min-resolution: 192dpi), only screen and (min-resolution: 2dppx)"}};return{set:function(b){a=b},$get:function(){return a}}}function e(a,c,d,e,f,g,h){function i(){(n.src||n.srcset)&&(a.complete=!0,l())}function j(){var b=n.readyState;!n.src&&!n.srcset||!n.complete&&"complete"!=b&&"loaded"!=b&&4!=b||(a.complete=!0,l())}function k(){m.on("error",i),m.on("load",j),m.on("readystatechange",j)}function l(){m.off("error",i),m.off("load",j),m.off("readystatechange",j)}var m,n,o={initialized:!1},p=[];a.complete=!1,this.attrs=function(){return{alt:d.alt,defaultSource:d.defaultSource,sources:d.sources,usemap:d.usemap}},this.init=function(){o.initialized||(o.initialized=!0,m=c.find("img"),n=m[0])},this.destroy=function(){b.forEach(p,function(a){e.cancel(a)}),m&&l()},this.reset=function(){o.initialized&&(this.destroy(),a.complete=!1,k())},this.update=function(d){if(o.initialized){this.reset();var i=a.$eval(d.sources),j=[];if(!b.isArray(i))throw new Error(f.t('Excepted attribute "!attribute" to evaluate to !type',{"!attribute":"sources","!type":"Array"}));for(var k=i.length,l=k-1;l>=0;l--){var m,n=i[l];b.isDefined(n[1])&&n[1]in g.mediaqueries&&(m=g.mediaqueries[n[1]]),j.push({srcset:n[0],media:m})}j.push({srcset:d.defaultSource}),a.sources=j,a.img={srcset:d.defaultSource,alt:d.alt,usemap:d.usemap},p.push(e(function(){h(c)}))}},a.width=function(){return a.complete&&n?n.scrollWidth:0},a.height=function(){return a.complete&&n?n.scrollHeight:0}}function f(){return{restrict:"EA",replace:!0,controller:"nbPictureController",templateUrl:"templates/nb-picture.html",link:function(a,b,c,d){d.init();var e=a.$watch(d.attrs,function(a){d.update(a)},!0);a.$on("$destroy",function(){e(),d.destroy()})}}}function g(){return{restrict:"EA",replace:!0,controller:"nbPictureController",templateUrl:"templates/nb-picture-once.html",link:function(a,b,c,d){d.init();var e=a.$watch(d.attrs,function(a){d.update(a),e()},!0);a.$on("$destroy",function(){e(),d.destroy()})}}}b.module("nb.picture",["nb.i18n","nb.picture.templates"]).factory("picturefill",c).provider("nbPictureConfig",d).directive("nbPicture",f).directive("nbPictureOnce",g).controller("nbPictureController",e),c.$inject=["$window"],e.$inject=["$scope","$element","$attrs","$timeout","nbI18N","nbPictureConfig","picturefill"]}(window,window.angular),angular.module("nb.picture.templates",["templates/nb-picture-bindonce.html","templates/nb-picture-once.html","templates/nb-picture.html"]),angular.module("templates/nb-picture-bindonce.html",[]).run(["$templateCache",function(a){a.put("templates/nb-picture-bindonce.html",'<picture>\n	<!--[if IE 9]><video style="display: none;"><![endif]-->\n	<source ng-repeat="source in sources"\n			bindonce="source"\n			bo-attr\n			bo-attr-srcset="source.srcset"\n			bo-attr-media="source.media" />\n	<!--[if IE 9]></video><![endif]-->\n	<img bindonce="img"\n		 bo-attr\n		 bo-attr-srcset="img.srcset"\n		 bo-attr-alt="img.alt"\n		 bo-attr-usemap="img.usemap" />\n</picture>')}]),angular.module("templates/nb-picture-once.html",[]).run(["$templateCache",function(a){a.put("templates/nb-picture-once.html",'<picture>\n	<!--[if IE 9]><video style="display: none;"><![endif]-->\n	<source ng-repeat="source in ::sources"\n			ng-srcset="{{::source.srcset}}"\n			ng-attr-media="{{::source.media}}" />\n	<!--[if IE 9]></video><![endif]-->\n	<img ng-srcset="{{::img.srcset}}"\n		 ng-attr-alt="{{::img.alt}}"\n		 ng-attr-usemap="{{::img.usemap}}" />\n</picture>')}]),angular.module("templates/nb-picture.html",[]).run(["$templateCache",function(a){a.put("templates/nb-picture.html",'<picture>\n	<!--[if IE 9]><video style="display: none;"><![endif]-->\n	<source ng-repeat="source in sources"\n			ng-srcset="{{source.srcset}}"\n			ng-attr-media="{{source.media}}" />\n	<!--[if IE 9]></video><![endif]-->\n	<img ng-srcset="{{img.srcset}}"\n		 ng-attr-alt="{{img.alt}}"\n		 ng-attr-usemap="{{img.usemap}}" />\n</picture>')}]);